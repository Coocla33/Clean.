<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Clean.</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">

          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#home">
            <img alt="Brand" height="20" src="./images/webLogoDark.png">
          </a>
        </div>

        <div class="collapse navbar-collapse" id="navbar">
          <ul class="nav navbar-nav">
            <li>
              <a href="#home">Home</a>
            </li>
            <li>
              <a href="#about">About</a>
            </li>
            <li>
              <a href="#stats">Stats</a>
            </li>
            <li>
              <a href="#commands">Commands</a>
            </li>
          </ul>

          <ul class="nav navbar-nav navbar-right">
            <li>
              <a href="#" target="_blank">Support Server</a>
            </li>
            <li>
              <a href="https://discordapp.com/oauth2/authorize?client_id=305821126083215380&scope=bot" target="_blank">Bot Invite</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div id="home" style="margin-top: 70px;">
      <div class="container" style="border: solid 1px #d5d5d5; background-color: #f5f5f5; margin-bottom: 20px;">
        <div class="row">
          <img class="img-responsive" src="./images/webLogoDark.png" alt="Brand" style="margin-left: auto; margin-right: auto; margin-top: 32px;">
          <h3 class="text-center">A multi functional Discord Bot.</h3>
        </div>
      </div>
    </div>

    <div id="about">
      <div class="container">
        <div class="row">
          <div class="col-md-4 center" style="margin-bottom: 20px;">
            <span>
              <span class="glyphicon glyphicon-cog rotate" style="font-size: 4em;"></span>
              <h4>Functionality</h4>
              <hr style="margin: 8px;">
              <b>Clean.</b> can do a little bit of everything, from creating statistic driven graphs to playing a random sound in a voice channel.
            </span>
          </div>
          <div class="col-md-4 center" style="margin-bottom: 20px;">
            <span>
              <span class="glyphicon glyphicon-time" style="font-size: 4em;"></span>
              <h4>Uptime</h4>
              <hr style="margin: 8px;">
              <b>Clean.</b> is hosted on a <b>VPS</b> which means the bot will be online <b>24/7</b>. Our <b>#1</b> priority is to get the highest uptime possible, we do not want the bot to crash in needs of use.
            </span>
          </div>
          <div class="col-md-4 center" style="margin-bottom: 20px;">
            <span>
              <span class="glyphicon glyphicon-home" style="font-size: 4em;"></span>
              <h4>Accessibility</h4>
              <hr style="margin: 8px;">
              <b>Clean.</b> is a <b>Discord Bot</b>, which means <b>everybody</b> can use it! You can use it on your phone, laptop, pc. Everywhere!
            </span>
          </div>
        </div>
      </div>
    </div>

    <div id="stats">
      <div class="container box-overlay">
        <div class="section">
          <div class="row">
            <h1 class="text-center statsHeader">Statistics</h1>
            <hr id="statLine">
            <div class="col s12 center inline stats">
              <span>
                <h3 id="user-count">...</h3>
                <p>Total Users</p>
              </span>
              <span>
                <h3 id="guild-count">...</h3>
                <p>Total Guilds</p>
              </span>
              <span>
                <h3 id="channel-count">...</h3>
                <p>Total Channels</p>
              </span>
              <span>
                <h3 id="uptime">...</h3>
                <p>Uptime</p>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="commands">
      <div class="container">
        <div class="row">
          <div class="row">
            <h1 class="text-center">Commands</h1>
            <hr style="margin: 8px; width: 96%; margin-left: auto; margin-right: auto;">
            <h4 class="text-center">These are all the Commands of <b>Clean.</b></h4>
            <div class="col s12 center inline" id="commandContainer">

            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src='/socket.io/socket.io.js'></script>
    <script>
      $(function() {
        let socket = io.connect()
        let userCount = $('#user-count')
        let guildCount = $('#guild-count')
        let channelCount = $('#channel-count')
        let uptime = $('#uptime')
        let commandContainer = $('#commandContainer')

        socket.emit('getStats')
        socket.emit('getCommands')

        socket.on('updateStats', (stats) => {
          userCount.text(stats.userCount)
          guildCount.text(stats.guildCount)
          channelCount.text(stats.channelCount)
          uptime.text(stats.uptime)
        })

        socket.on('updateUptime', (Uptime) => {
          uptime.text(Uptime)
        })

        socket.on('updateCommands', (data) => {
          let cache = []
          for (let type in data) {
            for (let command in data[type]) {
              if (type != 'unlisted' && type != 'developer') {
                let htmlObject = []
                let badge = {'color': '', 'type': ''}
                if (data[type][command].new) {
                  badge.color = 'green'
                  badge.type = 'New'
                } else if (data[type][command].indev) {
                  badge.color = 'red'
                  badge.type = 'Indev'
                } else if (data[type][command].dm) {
                  badge.color = 'orange'
                  badge.type = 'DM'
                }
                htmlObject.push('<div class="columnContainer filled" style="margin: 0px -8px 16px -8px">')
                if (badge.type != '') {
                  htmlObject.push('<h3 class="commandName">' + data[type][command].name + ' <span class="badge commandBadge badge-' + badge.color + '">' + badge.type + '</span></h3>')
                } else {
                  htmlObject.push('<h3 class="commandName">' + data[type][command].name + '</h3>')
                }
                if (data[type][command].aliases) {
                  htmlObject.push('<h6 style="color: #a7a7a7; margin-top: -8px;">' + data[type][command].aliases.join(', ') + '</h6>')
                } else {
                  htmlObject.push('<h6 style="color: #a7a7a7; margin-top: -8px;">No Aliases</h6>')
                }
                htmlObject.push('<hr style="margin: 8px;">')
                htmlObject.push('<p>' + data[type][command].desc + '</p>')
                htmlObject.push('</div>')
                cache.push(htmlObject.join(''))
              }
            }
          }
          let objectsLeft = cache.length - Math.floor(cache.length / 4) * 4
          let final = []
          for (let i in cache) {
            if (i >= cache.length - objectsLeft) {
              if (objectsLeft == 1) {
                final.push('<div class="col-md-12">' + cache[i] + '</div>')
              } else if (objectsLeft == 2) {
                final.push('<div class="col-md-6">' + cache[i] + '</div>')
              } else {
                final.push('<div class="col-md-4">' + cache[i] + '</div>')
              }
            } else {
              final.push('<div class="col-md-3">' + cache[i] + '</div>')
            }
          }
          console.log(data)
          commandContainer.html(final.join(''))
        })

        $('#navbar a').on('click', function(event) {
          if (this.hash !== '') {
            event.preventDefault()
            let hash = this.hash
            $('html, body').animate({
              scrollTop: $(hash).offset().top - 71
            }, 500, function() {
              window.location.hash = hash
            });
          }
        });
      })
    </script>
  </body>
</html>
